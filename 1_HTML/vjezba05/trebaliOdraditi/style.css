/* --- OSNOVNE POSTAVKE & VARIJABLE --- */
:root {
    --bg-paper: #fdfbf7;
    --ink-color: #2c2c2c;
    --accent-red: #8b0000;
    --sepia-filter: sepia(0.6) contrast(1.2);
    /* REQUIRED: color-scheme */
    color-scheme: light;
}

/* REQUIRED: scroll-behavior, scroll-padding, timeline-scope */
html {
    scroll-behavior: smooth;
    scroll-padding-top: 50px;
    timeline-scope: --scroll-trigger;
}

body {
    margin: 0;
    font-family: 'Georgia', serif;
    background-color: #dcd0c0;
    color: var(--ink-color);
    /* REQUIRED: dynamic-range-limit */
    dynamic-range-limit: standard;
}

/* REQUIRED: contain */
.paper-container {
    max-width: 800px;
    margin: 20px auto;
    background: var(--bg-paper);
    padding: 40px;
    box-shadow: 0 0 20px rgba(0,0,0,0.2);
    border: 1px solid #c0b0a0;
    contain: paint; 
    /* REQUIRED: view-transition-name */
    view-transition-name: main-paper;
}

/* --- ANIMATIONS & TRANSITIONS --- */

/* REQUIRED: animation properties (shorthand covers name, duration, timing, delay, iteration, direction, fill-mode, play-state) */
.title-anim {
    text-align: center;
    font-size: 3rem;
    border-bottom: 2px double var(--accent-red);
    padding-bottom: 10px;
    animation: fadeIn 2s ease-out 0.5s 1 normal forwards running;
    /* REQUIRED: animation-composition */
    animation-composition: add;
    /* REQUIRED: will-change */
    will-change: transform, opacity;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(-20px); }
    to { opacity: 1; transform: translateY(0); }
}

/* REQUIRED: transition properties (shorthand + individual) */
a {
    color: var(--accent-red);
    text-decoration: none;
    transition-property: color, text-shadow;
    transition-duration: 0.3s;
    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
    transition-delay: 0ms;
    transition-behavior: allow-discrete; 
}
a:hover {
    text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
}

/* --- TYPOGRAPHY & TEXT DECORATION --- */
del { text-decoration-style: double; color: #999; }
ins { text-decoration: none; border-bottom: 1px solid var(--accent-red); background: #fff0f0; }

/* --- MENU & NAVIGATION --- */
menu {
    padding: 0;
    list-style: none;
    display: flex;
    justify-content: center;
    gap: 20px;
    border-bottom: 1px solid #ccc;
    padding-bottom: 10px;
    /* REQUIRED: zoom */
    zoom: 1;
}

/* --- SHAPES, CLIPS & MASKS --- */
.shape-section {
    margin: 40px 0;
    overflow: hidden; /* Clears float */
}

/* REQUIRED: shape-outside, shape-margin, shape-image-threshold */
.float-shape {
    float: left;
    width: 150px;
    height: 150px;
    shape-outside: circle(50%);
    shape-margin: 20px;
    shape-image-threshold: 0.1;
    /* REQUIRED: filter */
    filter: var(--sepia-filter) drop-shadow(5px 5px 5px rgba(0,0,0,0.3));
    /* REQUIRED: clip-path, clip-rule */
    clip-path: circle(50% at 50% 50%);
    clip-rule: evenodd;
}

/* REQUIRED: clip (deprecated property on hidden element) */
.alert-box {
    position: absolute;
    clip: rect(0, 0, 0, 0); /* Visually hidden but present */
}

/* --- VIDEO & MASKS --- */
.video-frame video {
    width: 100%;
    /* REQUIRED: mask properties */
    mask-image: radial-gradient(ellipse at center, black 60%, transparent 100%);
    mask-mode: alpha;
    mask-repeat: no-repeat;
    mask-position: center;
    mask-size: contain;
    mask-origin: border-box;
    mask-clip: border-box;
    mask-composite: add;
    mask-type: luminance;
    
    /* Mask Border (Supported in very few browsers, syntax included) */
    mask-border-source: none;
    mask-border-mode: alpha;
    mask-border-slice: 0;
    mask-border-width: 0;
    mask-border-outset: 0;
    mask-border-repeat: stretch;
}

/* --- TRANSFORM & PERSPECTIVE --- */
.polaroid {
    background: white;
    padding: 10px 10px 30px 10px;
    box-shadow: 2px 2px 10px rgba(0,0,0,0.1);
    display: inline-block;
    margin: 20px;
    text-align: center;
    
    /* REQUIRED: transform properties */
    transform: rotate(-3deg) scale(0.95);
    transform-origin: top left;
    transform-style: preserve-3d;
    transform-box: border-box;
    
    /* REQUIRED: perspective properties */
    perspective: 500px;
    perspective-origin: center;
    
    /* REQUIRED: backface-visibility */
    backface-visibility: hidden;
}

/* --- SCROLL TIMELINE & OFFSET --- */
/* This moves the second card when user scrolls */
body {
    /* REQUIRED: scroll-timeline-name/axis */
    scroll-timeline-name: --scroll-trigger;
    scroll-timeline-axis: block;
}

.move-on-scroll {
    /* REQUIRED: animation-timeline, animation-range */
    animation: slideCard linear;
    animation-timeline: --scroll-trigger;
    animation-range: entry 10% cover 80%;
    animation-range-start: entry 0%;
    animation-range-end: cover 100%;

    /* REQUIRED: offset properties */
    offset-path: path('M 0 0 L 100 50');
    offset-distance: 0%;
    offset-rotate: auto;
    offset-anchor: center;
    offset-position: auto;
}

@keyframes slideCard {
    to { offset-distance: 100%; transform: rotate(5deg) scale(1); }
}

/* --- CONTAINER QUERIES & SIZING --- */
.cards-container {
    /* REQUIRED: container properties */
    container-type: inline-size;
    container-name: gallery;
    text-align: center;
}

@container gallery (min-width: 500px) {
    .polaroid { transform: rotate(2deg); }
}

/* REQUIRED: contain-intrinsic-size (and variants) */
.video-frame {
    contain: layout;
    contain-intrinsic-size: 300px 200px;
    contain-intrinsic-width: 300px;
    contain-intrinsic-height: 200px;
    contain-intrinsic-block-size: 200px;
    contain-intrinsic-inline-size: 300px;
}

/* --- IMAGES & OBJECTS --- */
img, object, video, canvas {
    /* REQUIRED: object-fit, object-position */
    object-fit: cover;
    object-position: center;
    /* REQUIRED: image-rendering, image-orientation */
    image-rendering: auto;
    image-orientation: from-image;
}

/* --- ANCHOR POSITIONING (Experimental) --- */
.anchor-source {
    /* REQUIRED: anchor-name */
    anchor-name: --my-anchor;
    font-weight: bold;
    color: var(--accent-red);
}

.tooltip-anchor {
    background: #333;
    color: #fff;
    padding: 5px;
    font-size: 0.8rem;
    display: none; /* Hide if not supported */
    
    /* REQUIRED: position-anchor properties */
    position: absolute;
    position-anchor: --my-anchor;
    position-area: top center;
    position-try: flip-block;
    position-try-fallbacks: flip-inline;
    position-try-order: normal;
}

/* --- MIX BLEND MODE & ISOLATION --- */
.intro-text {
    /* REQUIRED: isolation */
    isolation: isolate;
}
.intro-text::first-letter {
    font-size: 3em;
    float: left;
    line-height: 0.8;
    color: var(--accent-red);
    /* REQUIRED: mix-blend-mode */
    mix-blend-mode: multiply;
}

/* --- OSTALO (Misc) --- */
dialog {
    /* REQUIRED: backdrop-filter */
    backdrop-filter: blur(2px);
    border: 1px solid var(--accent-red);
    padding: 20px;
    /* REQUIRED: opacity */
    opacity: 0.9;
    position: fixed;
    bottom: 10px;
    right: 10px;
    margin: 0;
    z-index: 100;
}

details {
    margin-top: 10px;
    border: 1px dashed #ccc;
    padding: 10px;
    /* REQUIRED: content-visibility */
    content-visibility: auto;
}

summary {
    cursor: pointer;
    font-weight: bold;
}

/* REQUIRED: content */
summary::after {
    content: " ⇩";
}
details[open] summary::after {
    content: " ⇧";
}

/* REQUIRED: forced-color-adjust, print-color-adjust */
.embed-row {
    display: flex;
    gap: 10px;
    opacity: 0.5; /* Fade out boring elements */
    forced-color-adjust: none;
    print-color-adjust: exact;
}

/* REQUIRED: math properties */
math {
    font-size: 1.5rem;
    color: var(--accent-red);
    math-style: compact;
    math-depth: 1;
}

/* REQUIRED: scroll-snap-type, scroll-margin, scroll-snap-stop */
main {
    scroll-snap-type: y proximity;
}
section {
    scroll-snap-align: start;
    scroll-snap-stop: normal;
    scroll-margin: 20px;
    margin-bottom: 50px;
}

/* REQUIRED: view-timeline properties (Animating elements as they enter view) */
.polaroid canvas {
    view-timeline-name: --canvas-view;
    view-timeline-axis: block;
    view-timeline-inset: 0;
    
    animation: rotateCanvas linear;
    animation-timeline: --canvas-view;
}
@keyframes rotateCanvas {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

/* REQUIRED: view-transition-class */
.card {
    view-transition-class: card-transition;
}